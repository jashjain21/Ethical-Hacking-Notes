<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>3.Spiking</title>
</head><body>We ran immnuity debugger as well as vulnserver as administrator so that we directly get root access once we get the access<br/>
rght click on file and click on attach in immunity debugger and click on vulnserver<br/>
click on start button <br/>
<br/>
by default conncet kali to vulnserver whoch runs on machone ip address and port 9999<br/>
<br/>
Ethernet adapter Ethernet 3:<br/>
<br/>
&nbsp; &nbsp;Connection-specific DNS Suffix &nbsp;. :<br/>
&nbsp; &nbsp;IPv4 Address. . . . . . . . . . . : 192.168.56.1<br/>
&nbsp; &nbsp;Subnet Mask . . . . . . . . . . . : 255.255.255.0<br/>
&nbsp; &nbsp;Default Gateway . . . . . . . . . :<br/>
--------------------------------------------------------------------------------------------------<br/>
Wireless LAN adapter Wi-Fi:<br/>
<br/>
&nbsp; &nbsp;Connection-specific DNS Suffix &nbsp;. :<br/>
&nbsp; &nbsp;IPv4 Address. . . . . . . . . . . : 192.168.0.108<br/>
&nbsp; &nbsp;Subnet Mask . . . . . . . . . . . : 255.255.255.0<br/>
&nbsp; &nbsp;Default Gateway . . . . . . . . . : 192.168.0.1<br/>
<br/>
port taken was of wifi not ethernet and it worked <br/>
sudo nc -nv 192.168.0.108 1234<br/>
C:\Users\windows\Desktop\ethical_hacking\0.Tools\vulnserver&gt;vulnserver.exe 1234<br/>
<img src="image.png" /><br/>
<br/>
focus would be on TRUN command here <br/>
we ll use spiking to find out whether trun command is vulnerable or not actually <br/>
so all theses commands that we see above we ll throw characters at them to find out whetger buffer overloww can be be achieved or not <br/>
fr spking using tool called general tcp <br/>
<img src="image 2.png" /><br/>
<br/>
so we need the spike script too<br/>
gedit stats.spk<br/>
<br/>
<img src="image 3.png" /><br/>
<br/>
so first read the line then <br/>
we ll take the string called as stats <br/>
and then we ll send the string_varibale at it <br/>
when we ll spike it we ll send characters in all different variations to it <br/>
<img src="image 4.png" /><br/>
<br/>
<img src="image 5.png" /><br/>
<br/>
last screen is of immunity debugger<br/>
&nbsp;in a real test u let it run theorugh the entire process bt here we know it isnt vulnerable <br/>
<br/>
now doing the same with TRUN to test its vulnerability <br/>
<img src="image 6.png" /><br/>
<br/>
see we got access violations while execting boom!!<br/>
and immnity starts blinking also <br/>
so kill the process in kali <br/>
actually vulnserver also crashed bt u couldnt see it coz it was being held by immunity debugger once u detach it u ll get to klnow <br/>
<img src="image 7.png" /><br/>
<br/>
seeing immunity we &nbsp;get to know <br/>
<img src="image 8.png" /><br/>
<br/>
in a perfect scenario the TRUN command ke A's should ve filled only the buffer space bt on having look at EBP it is 414141.... whihc is just hex code for A's(so there are 4 A's)<br/>
so there are 4 bytes and we have fone over esp as well as well as EIP<br/>
we know if we can get over it we can point it to anything <br/>
<br/>
so nect we ll learn how to fuzz the trun command so that we can get to know other method too and then we would find eip location to be malicious<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>